---
layout:     post
title:      PET OSDI 2023
subtitle:   PET Optimizing Tensor Programs with Partially Equivalent Transformations and Automated Corrections
date:       2024-12-09
author:     Treaseven
header-img: img/bg1.jpg
catalog: true
tags:
    - Tensor Program Optimizer
    - Deep Learning
    - Search Algorithm
---

### 已有的解决方案
Existing frameworks optimize tensor programs by applying fully equivalent transformations

### 新的解决方案
optimize tensor programs by exploiting partially equivalent transformations
面临的挑战
(1) ***examining equivalence*** and ***correction kernels*** - (为什么部分等价变换会影响模型的准确度)
(2) design space is substantially enlarged

**partially equivalent transformations**
* change the shape and linearization of its tensors
* replace less efficient operators with more optimized ones with similar semantics
* modify the graph structure of a tensor program to enable additional optimizations

<img width="1000" height="300" src="/img/post-pet-partially-equivalent.png"/>


### Design


<img width="400" height="400" src="/img/post-pet.png"/>


###### Multi-linear tensor programs (MLTPs)

<img width="300" height="100" src="/img/post-mltps.png"/>


#### Mutation Generator
##### Mutation Generation Algorithm

<img width="400" height="400" src="/img/post-pet-mltp-algorithm.png"/>


#### Mutation Corrector
* 输出的算子可能十分大，对于算子的每个元素检查是不行的
* 每个输出的元素的验证可能取决于张量运算符中的大量输入变量

##### Theoretical Foundations

###### Theorem 1

###### Theorem 2

<img width="400" height="100" src="/img/post-pet-theorem2.png"/>